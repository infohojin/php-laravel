---
layout: laravel
title: Laravel
subtitle: Concepts
cate:
    name: "컨셉"
    link: "/Laravel/Concepts"


---

## 소개하기
---

라라벨을 통하여 어플리케이션을 개발할때 기반이 되는 라라벨의 기능과 구조를 알 이해하는 것은 중요합니다. 개발을 하다 보면 예상치 못하는 다양한 문제에 봉착하게 됩니다. 이련 경우 라라벨의 원리와 구조를 이해하고 있다면, 향후 개발시 발생될 수 있는 다양한 문제를 해결하는데 도움이 됩니다.

이번 장에서는 좀더 내부적인 라라벨의 동작원리에 대해서 설명을 합니다.

처음 라라벨을 접하는 사람에게는 이 설명이 라라벨에 대한 두려움과 더 어렵게 느껴질 수 있습니다. 하지만, 내부구조를 좀더 이해함으로서 프로젝트를 개발하는데 자신감을 가지고 다양한 해결책을 얻을 수 있을 것입니다.



## 라이프사이클
---

대부분의 개발자들은 처음 프레임워크의 접할때 시작포인트에 대해서 혼동합니다. 라라벨의 시작포인트는 `public/index.php` 파일입니다. 웹서버 (Apache / Nginx) 설정에 따라 차이가 있겠지만 첫 동작의 시작은 이곳에서 시작됩니다.

라라벨의 첫 동작을 가지는 `index.php` 파일 안에는 많은 코드를 가지고 있지 않습니다. 간단하게 프레임워크를 시작 로징하기 위한 몇개의 코드만 가지고 있습니다.

`index.php` 파일은 라라벨에서 필요한 클래스 파일들을 자동으로 로딩하기 위한  컴포저 오토로더를 정의합니다.

그리고, `bootstrap/app.php` 코드에서 라라벨의 필요한 애플리케이션 인스턴스를 가져옵니다. 라라벨 프레임 워크의 첫번째로 동작하는 기능은 `서비스 컨테이너 인스턴스`를 생성하는 것입니다.

<br>

## HTTP / Console 커널
---

라라벨의 두번째 동작으로 시작유형에 따라 HTTP처리 또는 콘솔처리를 담당하는 커널코드를 실행합니다. HTTP와 콘솔의 앞부분의 시작코드는 동일하기 때문이 이곳에서 유형에 따라 2가지 방식으로 나누어 지게 됩니다.

이번장에서는 HTTP요청 저리인 `app/Http/Kernel.php` 에 대해서 좀더 상세히 알아 보도록 하겠습니다. 콘솔은 다른 추가 설명문서를 참고해 주시면 됩니다.

HTTP 커널 소스는 `Illuminate\Foundation\Http\Kernel` 클래스를 상속합니다. 이곳에서는 처리 요청을 실행하기 전에 필요한 bootstrappers (시작 코드)의 배열값을 정의 합니다.

이 시작 코드들은 에러 처리, 로그 설정, 애플리케이션 동작 환경의 감지 등 실제로 요청이 처리되기 전에 수행해야 되는 작업들을 의미합니다.

또한 HTTP 커널은 미들웨어를 정의하기도 합니다. 미들웨어는 애플리케이션에서 요청이 처리되기 전에 미리 동작해야 되는 코드들 입니다. 미들웨어들은 HTTP 세션을 읽고/쓰고, 애플리케이션이 유지 관리 모드인지 확인하고, CSRF 토큰을 확인 하는 작업들을 주로 처리합니다.

HTTP 커널의 `handle` 메소드의 사용법은 매우 간단합니다. 
`handle`은 단순하게는 Request 를 받고 Response를 반환합니다. 커널을 애플리케이션 전체를 나타내는 하나의 큰 블랙 박스라고 생각해도 좋습니다.
커널은 HTTP 요청이 입력되면 HTTP 응답이 반환됩니다.

<br>

## 서비스 프로바이더
---

커널 부팅을 다른말로 부트스트래핑이라고 합니다. 이 과정에서 가장 중요한 동작은 어플리케이션에서 필요한 서비스 프로바이더를 로딩하는 처리 입니다. 애플리케이션에서 로딩해야 되는 서비스 프로바이더는 `config/app.php` 파일에 정의되어 있습니다. 이 목록들은 `providers` 배열로 되어 있습니다.

서비스 프로바이더의 동작을 살펴보면 `register` 메소드가 먼저 호출이 됩니다. 그후에 미리 정의된 모든 목록들 각각의 `boot` 메소드를 호출합니다.

서비스 프로바이더는 라라벨의 데이터베이스, 큐, validation, 라우팅 컴포넌트와 같은 다양한 컴포넌트의 초기화 동작들을 처리합니다. 이를 서비스 프로바이터 부트스트래핑이라고 합니다.
서비스 프로바이더는 라라벨이 제공하는 모든 기능을 초기화 하고 설정하는 것으로, 라라벨이 시작하는 과정에서 가장 중요한 기능이라고 할 수 있습니다.

<br>

### 요청 처리-디스패칭
---

서비스 프로바이더를 통하여 애플리케이션의 모든 초기화 부팅작업이 되면, 라라벨은 라우터 처리를 하게 됩니다. 라우터는 라우팅과정으로 요청한 request에 대해서 컨트롤러를 매칭하여 줍니다.

또한 임의의 특정 라우트에 지정된 미들웨어도 같이 실행합니다.

<br>


## 서비스 프로바이더
---

서비스 프로바이더는 라라벨 애플리케이션들을 초기화 하는 중요 동작입니다. 서비스 프로바이터는 목록화된 각각의 애플리케이션 인스턴스를 생성합니다. 
서비스 프로바이더가 목록으로 등록되면 부트스트래핑 과정 통하여 프로그램으로 요청이 전달됩니다. 라라벨 애플리케이션이 어떻게 구성되어 있는지, 서비스 프로바이더를 통해 부트스트랩되는 과정을 구체적으로 이해하는 것은 매우 중요합니다. 

물론 사용자 애플리케이션을 위한 서비스 프로바이더는 `app/Providers` 디렉토리에 있습니다. 기본적으로 `AppServiceProvider` 는 거의 비어 있습니다. 

이 프로바이더는 사용자 여러분의 고유한 부트스트래핑과 서비스 컨테이너 바인딩 코드를 추가하기 위해 제공되는 곳입니다. 

물론 보다 큰 애플리케이션의 경우, 보다 세부적인 유형으로 구분된 종류별로 서비스 프로바이더를 만들 수도 있습니다.


